<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quick Auto-Pagination Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 50px auto;
        padding: 20px;
      }
      h1 {
        color: #007acc;
      }
      .test-section {
        background: #f5f5f5;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }
      button {
        background: #007acc;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      button:hover {
        background: #0056b3;
      }
      .status {
        margin-top: 20px;
        padding: 10px;
        border-radius: 4px;
        display: none;
      }
      .status.show {
        display: block;
      }
      .status.success {
        background: #d4edda;
        color: #155724;
      }
      .status.error {
        background: #f8d7da;
        color: #721c24;
      }
    </style>
  </head>
  <body>
    <h1>üß™ Extension Test Page</h1>

    <div class="test-section">
      <h2>Test 1: Check if Auto-Pagination Script Loads</h2>
      <button onclick="testAutoPaginationLoaded()">
        Test Auto-Pagination Guard
      </button>
      <div id="test1-status" class="status"></div>
    </div>

    <div class="test-section">
      <h2>Test 2: Check if Content Script Loads</h2>
      <button onclick="testContentLoaded()">Test Content Script Guard</button>
      <div id="test2-status" class="status"></div>
    </div>

    <div class="test-section">
      <h2>Test 3: Open Auto-Pagination Page</h2>
      <button onclick="testOpenAutoPagination()">
        Open Auto-Pagination Config
      </button>
      <div id="test3-status" class="status"></div>
    </div>

    <div class="test-section">
      <h2>Test 4: Check Extension Options</h2>
      <p>To test the "Auto-Extract Pages" button:</p>
      <ol>
        <li>Click the extension icon in your toolbar</li>
        <li>Look for settings or options menu</li>
        <li>Find the "Auto-Extract Pages" button (should replace "Contact")</li>
        <li>Click it - should open auto-pagination configuration</li>
      </ol>
    </div>

    <script>
      function testAutoPaginationLoaded() {
        const status = document.getElementById("test1-status");
        const loaded = typeof window.__stnAutoPaginationLoaded !== "undefined";

        status.className = "status show " + (loaded ? "error" : "success");
        status.textContent = loaded
          ? "‚ùå Script already loaded (may indicate duplicate injection)"
          : "‚úÖ Script not loaded yet (guard will work properly)";
      }

      function testContentLoaded() {
        const status = document.getElementById("test2-status");
        const loaded = typeof window.__stnContentLoaded !== "undefined";

        status.className = "status show " + (loaded ? "error" : "success");
        status.textContent = loaded
          ? "‚ùå Content script already loaded (may indicate duplicate injection)"
          : "‚úÖ Content script not loaded yet (guard will work properly)";
      }

      function testOpenAutoPagination() {
        const status = document.getElementById("test3-status");

        try {
          // Try to send message to extension
          chrome.runtime.sendMessage(
            { action: "openAutoPagination" },
            (response) => {
              if (chrome.runtime.lastError) {
                status.className = "status show error";
                status.textContent =
                  "‚ùå Extension not responding: " +
                  chrome.runtime.lastError.message;
              } else {
                status.className = "status show success";
                status.textContent = "‚úÖ Message sent to extension";
              }
            },
          );
        } catch (e) {
          status.className = "status show error";
          status.textContent = "‚ùå Error: " + e.message;
        }
      }

      console.log(
        "%cüß™ Extension Test Page Loaded",
        "color: #007acc; font-size: 16px; font-weight: bold;",
      );
      console.log("Run tests using the buttons above");
      console.log("Check for these global variables:");
      console.log(
        "  - window.__stnAutoPaginationLoaded:",
        typeof window.__stnAutoPaginationLoaded,
      );
      console.log(
        "  - window.__stnContentLoaded:",
        typeof window.__stnContentLoaded,
      );
    </script>
  </body>
</html>
